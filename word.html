<!DOCTYPE html>
<html>
  <head>

    <title>Talk to Me!</title>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="/style.css" />
    
    <link rel="icon" href="logo1.jpg">
  </head>

  <!-- NAVIGATION --> 
    <nav> 
      <ul>
        <li>
          <a href="index.html">Home</a>
        </li>
        <li>
           <a href="word.html">Word</a>
        </li>
        <li>
          <a href="sentence.html">Synonym</a>
        </li>
      </ul>

      </nav>
  <!-- NAVIGATON END --> 

   <h1>Word Generator</h1>
  <body>
    <p1> It was once said that <i>"The secret of success is consistency of purpose"</i>, therefore Talk2Me provides you a daily word for you to study, to help you reach your language goals.<br><br> </p1>
   
    <div id= "center2"> 
      Please input a phrase to detect your native language:
        <input type="text" id= "inputT" >
        <!-- <button type="button" class="button1"> Click me! </button> -->
        <!-- <button id= "input"> Enter </button> -->
        <button id= "input" button type="button" class="button1"> Click me! </button>
    </div>
    
    <div id= "center5">
      <p1> <br> This was your detected language:</p1>
      <p id = "lang"></p>
      
    <div id= "center3"> 
    <p1> <br> Here is your random word:</p1>
    <p id = "word"></p>
    </div>

    <div id= "center4">
    <p> Here is your random word's translation: </p>
    <p id = "translatedword"></p>
    </div>

      <!--all the api call -->
    <script>
      const languageCodes = [{name:"Auto Detect", code: "auto" },
          {name:"Afrikaans", code: "af" },
          {name:"Albanian", code: "sq" },
          {name:"Amharic", code: "am" },
          {name:"Arabic", code: "ar" },
          {name:"Armenian", code: "hy" },
          {name:"Azerbaijani", code: "az" },
          {name:"Basque", code: "eu" },
          {name:"Belarusian", code: "be" },
          {name:"Bengali", code: "bn" },
          {name:"Bosnian", code: "bs" },
          {name:"Bulgarian", code: "bg" },
          {name:"Catalan", code: "ca" },
          {name:"Cebuano", code: "ceb" },
          {name:"Chinese (Simplified)", code: "zh-CN" },
          {name:"Chinese (Traditional)", code: "zh-TW" },
          {name:"Corsican", code: "co" },
          {name:"Croatian", code: "hr" },
          {name:"Czech", code: "cs" },
          {name:"Danish", code: "da" },
          {name:"Dutch", code: "nl" },
          {name:"English", code: "en" },
          {name:"Esperanto", code: "eo" },
          {name:"Estonian", code: "et" },
          {name:"Finnish", code: "fi" },
          {name:"French", code: "fr" },
          {name:"Frisian", code: "fy" },
          {name:"Galician", code: "gl" },
          {name:"Georgian", code: "ka" },
          {name:"German", code: "de" },
          {name:"Greek", code: "el" },
          {name:"Gujarati", code: "gu" },
          {name:"Haitian Creole", code: "ht" },
          {name:"Hausa", code: "ha" },
          {name:"Hawaiian", code: "haw" },
          {name:"Hebrew", code: "iw" },
          {name:"Hindi", code: "hi" },
          {name:"Hmong", code: "hmn" },
          {name:"Hungarian", code: "hu" },
          {name:"Icelandic", code: "is" },
          {name:"Igbo", code: "ig" },
          {name:"Indonesian", code: "id" },
          {name:"Irish", code: "ga" },
          {name:"Italian", code: "it" },
          {name:"Japanese", code: "ja" },
          {name:"Javanese", code: "jv" },
          {name:"Kannada", code: "kn" },
          {name:"Kazakh", code: "kk" },
          {name:"Khmer", code: "km" },
          {name:"Kinyarwanda", code: "rw" },
          {name:"Korean", code: "ko" },
          {name:"Kurdish (Kurmanji)", code: "ku" },
          {name:"Kurdish (Sorani)", code: "ckb" },
          {name:"Kyrgyz", code: "ky" },
          {name:"Lao", code: "lo" },
          {name:"Latin", code: "la" },
          {name:"Latvian", code: "lv" },
          {name:"Lithuanian", code: "lt" },
          {name:"Luxembourgish", code: "lb" },
          {name:"Macedonian", code: "mk" },
          {name:"Malagasy", code: "mg" },
          {name:"Malay", code: "ms" },
          {name:"Malayalam", code: "ml" },
          {name:"Maltese", code: "mt" },
          {name:"Maori", code: "mi" },
          {name:"Marathi", code: "mr" },
          {name:"Mongolian", code: "mn" },
          {name:"Myanmar (Burmese)", code: "my" },
          {name:"Nepali", code: "ne" },
          {name:"Norwegian", code: "no" },
          {name:"Nyanja (Chichewa)", code: "ny" },
          {name:"Odia (Oriya)", code: "or" },
          {name:"Pashto", code: "ps" },
          {name:"Persian", code: "fa" },
          {name:"Polish", code: "pl" },
          {name:"Portuguese (Portugal, Brazil)", code: "pt" },
          {name:"Punjabi", code: "pa" },
          {name:"Romanian", code: "ro" },
          {name:"Russian", code: "ru" },
          {name:"Samoan", code: "sm" },
          {name:"Scots Gaelic", code: "gd" },
          {name:"Serbian", code: "sr" },
          {name:"Sesotho", code: "st" },
          {name:"Shona", code: "sn" },
          {name:"Sindhi", code: "sd" },
          {name:"Sinhala (Sinhalese)", code: "si" },
          {name:"Slovak", code: "sk" },
          {name:"Slovenian", code: "sl" },
          {name:"Somali", code: "so" },
          {name:"Spanish", code: "es" },
          {name:"Sundanese", code: "su" },
          {name:"Swahili", code: "sw" },
          {name:"Swedish", code: "sv" },
          {name:"Tagalog (Filipino)", code: "tl" },
          {name:"Tajik", code: "tg" },
          {name:"Tamil", code: "ta" },
          {name:"Tatar", code: "tt" },
          {name:"Telugu", code: "te" },
          {name:"Thai", code: "th" },
          {name:"Turkish", code: "tr" },
          {name:"Turkmen", code: "tk" },
          {name:"Ukrainian", code: "uk" },
          {name:"Urdu", code: "ur" },
          {name:"Uyghur", code: "ug" },
          {name:"Uzbek", code: "uz" },
          {name:"Vietnamese", code: "vi" },
          {name:"Welsh", code: "cy" },
          {name:"Xhosa", code: "xh" },
          {name:"Yiddish", code: "yi" },
          {name:"Yoruba", code: "yo" },
          {name:"Zulu", code: "zu" }];
      
      document.getElementById("input").addEventListener("click", display);

      function display() {
        var sentence = document.getElementById("inputT").value;
        let userInput = sentence;

        const requestData = JSON.stringify({
          text: userInput
        });

        const xhr2 = new XMLHttpRequest();
        xhr2.withCredentials = true;

        xhr2.addEventListener('readystatechange', function () {
          if (this.readyState === this.DONE) {
            console.log(this.responseText);
            const responseObj = JSON.parse(this.responseText);
            const languageCode = responseObj.language_detection.language;
            let languageName = "";
            for (let i = 0; i < languageCodes.length; i++) {
                if (languageCodes[i].code === languageCode) {
                    languageName = languageCodes[i].name;
                    break;
                }
            }
            document.getElementById("lang").innerHTML = languageName;
            console.log(languageCode);

            // get random word after getting response
            const data = null;
            const xhr = new XMLHttpRequest();
            xhr.withCredentials = true;

            xhr.addEventListener('readystatechange', function () {
              if (this.readyState === this.DONE) {
                const wordnew = this.responseText;
                document.getElementById("word").innerHTML = wordnew;

                // translate random word after getting wordnew
                const userInputText = wordnew;
                const userInputSource = 'en';
                const userInputTarget = languageCode;

                const requestData2 = JSON.stringify({
                  text: userInputText,
                  source: userInputSource,
                  target: userInputTarget
                });

                const xhr3 = new XMLHttpRequest();
                xhr3.withCredentials = true;

                xhr3.addEventListener('readystatechange', function () {
                    if (this.readyState === this.DONE) {
                    const responseObj = JSON.parse(this.responseText);
                    const translation = responseObj.translations.translation;
                    document.getElementById("translatedword").innerHTML = translation;
                    }
                });

                xhr3.open('POST', 'https://translate-plus.p.rapidapi.com/translate');
                xhr3.setRequestHeader('content-type', 'application/json');
                xhr3.setRequestHeader('X-RapidAPI-Key', '6658814679msh10d39f30de28b22p18a787jsn8934f5e9e73f');
                xhr3.setRequestHeader('X-RapidAPI-Host', 'translate-plus.p.rapidapi.com');
                xhr3.send(requestData2);
              }
            });

            xhr.open('GET', 'https://random-words5.p.rapidapi.com/getRandom');
            xhr.setRequestHeader('X-RapidAPI-Key', '6658814679msh10d39f30de28b22p18a787jsn8934f5e9e73f');
            xhr.setRequestHeader('X-RapidAPI-Host', 'random-words5.p.rapidapi.com');
            xhr.send(data);
          }
        });

        xhr2.open('POST', 'https://translate-plus.p.rapidapi.com/language_detect');
        xhr2.setRequestHeader('content-type', 'application/json');
        xhr2.setRequestHeader('X-RapidAPI-Key', '6658814679msh10d39f30de28b22p18a787jsn8934f5e9e73f');
        xhr2.setRequestHeader('X-RapidAPI-Host', 'translate-plus.p.rapidapi.com');
        xhr2.send(requestData);
      }
    </script> 
    
    <img src="logo1.jpg" alt="logo" width="25%" height="25%">  
  </body>

</html>